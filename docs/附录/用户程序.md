运行用户程序了！

OS 为什么区分多个特权级，通常我们知道至少分为内核态和用户态。特权级主要是为了保护操作系统的，比如用户态不能执行某些指令访问某些寄存器。特权级需要软件和硬件配合，也就是特权级其实在 CPU 里就实现了。

低特权级必须通过 Trap 来通过高特权级的帮助，也就是常说的系统调用。

介绍完这些之后，user_lib 可以通过 trap 来“调用”输出等低特权级不能调用的功能，操作系统再通过 trap 委托给 SBI 也可以自己在允许的情况下自己实现驱动来完成功能。

问题：

1. 在 app 进行 IO trap 的时候不能切换 app 来提高 CPU 的利用率。

附录：

1. 汇编才有足够的灵活性来 system call
2. 数组在内存中是连续的，只要内存布局一样就一样，如 TrapContext 在 trap.S 的 37 行，sp 的内存布局就和 TapContext 一样。
3. Sp 是内核栈顶，csrrw sp, sscratch, sp 是交换 sp 和 sscratch 。也就是在这 sscratch 设置为内核栈顶。